{% extends "layout.html" %}
{% block content %}
  <section class="card">
    <div class="card-header">
      <h2>ðŸ§¾ Action Details</h2>
      <a class="button secondary" href="/ui/actions">Back to list</a>
    </div>
    <h3>{{ action.title }}</h3>
    <p class="muted">{{ action.description or "No description provided." }}</p>
    <div class="detail-grid">
      <div><strong>Status</strong><p><span class="status-badge status-{{ action.status|lower }}">{{ action.status }}</span></p></div>
      <div><strong>Champion</strong><p>{{ action.champion.full_name if action.champion else "â€”" }}</p></div>
      <div><strong>Project</strong><p>{{ action.project.name if action.project else "â€”" }}</p></div>
      <div><strong>Owner</strong><p>{{ action.owner or "â€”" }}</p></div>
      <div><strong>Created at</strong><p>{{ format_date(action.created_at) }}</p></div>
      <div><strong>Due date</strong><p>{{ format_date(action.due_date) }}</p></div>
      <div><strong>Closed at</strong><p>{{ format_date(action.closed_at) }}</p></div>
      <div><strong>Days late</strong><p>{{ days_late }}</p></div>
    </div>

    <div class="card" style="padding:16px;margin-top:12px;">
      <h4>Tags</h4>
      {% if action.tags %}
        <div class="tag-list">
          {% for tag in action.tags %}
            <form method="post" action="/ui/actions/{{ action.id }}/tags/{{ tag.id }}/delete" class="tag-form">
              <span class="tag-chip" {% if tag.color %}style="--tag-color: {{ tag.color }}"{% endif %}>{{ tag.name }}</span>
              <button class="tag-remove" type="submit">Ã—</button>
            </form>
          {% endfor %}
        </div>
      {% else %}
        <p class="muted">No tags yet.</p>
      {% endif %}
      <form method="post" action="/ui/actions/{{ action.id }}/tags" class="form-inline" style="margin-top:8px;">
        <label>
          Add tag
          <input type="text" name="tag_name" list="action-tags-list" placeholder="Type or create tag" required />
        </label>
        <datalist id="action-tags-list">
          {% for tag in all_tags %}<option value="{{ tag.name }}"></option>{% endfor %}
        </datalist>
        <button class="button secondary" type="submit">Add</button>
      </form>
    </div>

    <form method="post" action="/ui/actions/{{ action.id }}/delete">
      <button class="button danger" type="submit">Delete action</button>
    </form>
  </section>
  {% include "partials/subtasks.html" %}
{% endblock %}
